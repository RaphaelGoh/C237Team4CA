<%- include('partials/header') %>

<div class="container mt-5">
  <h2 class="mb-4">Your Cart</h2>

  <% if (cart.length === 0) { %>
    <p>Your cart is empty.</p>
  <% } else { %>
    <form action="/cart/edit" method="POST">
      <table class="table table-bordered">
        <thead>
          <tr>
            <th>Image</th>
            <th>Product</th>
            <th>Price (SGD)</th>
            <th>Quantity</th>
            <th>Total</th>
            <th>Action</th>
          </tr>
        </thead>
        <tbody>
          <% let grandTotal = 0; %>
          <% cart.forEach(item => { %>
            <% let itemTotal = item.price * item.quantity; %>
            <% grandTotal += itemTotal; %>
            <tr>
              <td><img src="<%= item.image %>" alt="<%= item.productName %>" style="width: 60px;"></td>
              <td><%= item.productName %></td>
              <td>$<%= item.price.toFixed(2) %></td>
              <td>
                <input type="hidden" name="productIds" value="<%= item.productId %>">
                <input type="number" name="quantities" value="<%= item.quantity %>" min="1" class="form-control" style="width: 80px;">
              </td>
              <td>$<%= itemTotal.toFixed(2) %></td>
              <td>
                <a href="/cart/delete/<%= item.productId %>" class="btn btn-sm btn-danger">Remove</a>
              </td>
            </tr>
          <% }); %>
          <tr>
            <td colspan="4" class="text-end fw-bold">Grand Total:</td>
            <td colspan="2" class="fw-bold">$<%= grandTotal.toFixed(2) %></td>
          </tr>
        </tbody>
      </table>

      <button type="submit" class="btn btn-primary">Update Cart</button>
    </form>
  <% } %>

  <a href="/menu" class="btn btn-secondary mt-3">Continue Shopping</a>
</div>

<%- include('partials/footer') %>
